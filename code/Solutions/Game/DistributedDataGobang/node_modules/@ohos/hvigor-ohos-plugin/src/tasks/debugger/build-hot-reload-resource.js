"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(e,o,r,t){void 0===t&&(t=r);var s=Object.getOwnPropertyDescriptor(o,r);s&&!("get"in s?!o.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(e,t,s)}:function(e,o,r,t){void 0===t&&(t=r),e[t]=o[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(e,o){Object.defineProperty(e,"default",{enumerable:!0,value:o})}:function(e,o){e.default=o}),__importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var o={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(o,e,r);return __setModuleDefault(o,e),o};Object.defineProperty(exports,"__esModule",{value:!0}),exports.BuildHotReloadResource=void 0;const ohos_logger_js_1=require("../../utils/log/ohos-logger.js"),generate_loader_json_js_1=require("../generate-loader-json.js"),compile_resource_js_1=require("../compile-resource.js"),task_names_js_1=require("../common/task-names.js"),compile_mode_enum_js_1=require("../../enum/compile-mode-enum.js"),hap_extra_info_js_1=require("../../project/data/hap-extra-info.js"),abstract_module_hook_task_js_1=require("../hook/abstract-module-hook-task.js"),error_url_js_1=require("../../utils/error-url.js"),os=__importStar(require("os"));class BuildHotReloadResource extends abstract_module_hook_task_js_1.AbstractModuleHookTask{constructor(e){super(e,!1,task_names_js_1.TaskNames.CommonHookTask.BUILD_HOT_RELOAD_RES),this._log=ohos_logger_js_1.OhosLogger.getLogger(BuildHotReloadResource.name),this.registryAction=()=>()=>{(this._moduleService.getModuleModel().getCompileMode()!==compile_mode_enum_js_1.CompileModeEnum.ES_MODULE||this._moduleService.getModuleModel().getApiType()!==hap_extra_info_js_1.ApiType.STAGE||this._moduleService.getModuleModel().getCompileApiVersion()<9)&&this._log._buildError("Hot reload is only supported for esmodule mode in the stage model.")._solution(`Please check attribute apiType and compileMode from build-profile.json5. For details about hot reload, ${os.EOL}see ${error_url_js_1.ErrorUrl.ERROR_URL.hotReload}.`)._file(this._moduleService.getModuleModel().getProfilePath())._printErrorAndExit(this._moduleService.getModuleModel().getName()),this._log.debug("Hot reload resources ready.")}}initTaskDepends(e){this.node.registryDependsOnTask(this,new generate_loader_json_js_1.GenerateLoaderJson(e),new compile_resource_js_1.CompileResource(e))}}exports.BuildHotReloadResource=BuildHotReloadResource;