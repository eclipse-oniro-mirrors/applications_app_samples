"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ModuleInspection=void 0;const json5_reader_js_1=require("@ohos/hvigor-base/src/util/json5-reader.js"),module_type_enum_js_1=require("../../enum/module-type-enum.js"),hap_extra_info_js_1=require("../../project/data/hap-extra-info.js"),ohos_logger_js_1=require("../../utils/log/ohos-logger.js");class ModuleInspection{constructor(e){this._log=ohos_logger_js_1.OhosLogger.getLogger("Inspection"),this.moduleModel=e,this.projectModel=e.getParentProject()}doInspection(){return this.checkModuleType(),this.apiVersionCheck(),this}apiVersionCheck(){this.moduleModel.getApiType()===hap_extra_info_js_1.ApiType.STAGE&&9>this.projectModel.getCompileApiVersion()&&this._log._buildError(`API version ${this.projectModel.getCompileApiVersion()} does not support the Stage model.`)._file(this.projectModel.getProfilePath())._record()}checkModuleType(){if(this.moduleModel.getApiType()===hap_extra_info_js_1.ApiType.FA)return;const e=this.moduleModel.getPackageJsonPath(),o="module"===json5_reader_js_1.Json5Reader.getJson5Obj(e).type;this.moduleModel.getModuleType()!==module_type_enum_js_1.ModuleType.Har||o||this._log._buildError("Invalid module type! Please check the package.json of current library module.")._file(this.moduleModel.getPackageJsonPath())._detail('Set \'{ "type": "module" }\'.')._record()}exitOnError(){this._log._printAllExit()}}exports.ModuleInspection=ModuleInspection;