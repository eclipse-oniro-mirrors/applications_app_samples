"use strict";var __importDefault=this&&this.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.OhosLogger=void 0;const log4js_1=require("log4js"),hvigor_log_js_1=require("@ohos/hvigor-base/src/log/hvigor-log.js"),os_1=__importDefault(require("os")),util_1=__importDefault(require("util"));class OhosLogger extends hvigor_log_js_1.HvigorLogger{constructor(s){super(s),this.messageMap=new Map,this.errList=[]}static getLogger(s){return new OhosLogger(s)}_buildError(s,e){return e&&this.messageMap.set("code",e),this.messageMap.set("cause",s),this}_solution(s){return this.messageMap.set("solution",s),this}_detail(s){return this.messageMap.set("solution",s),this}_help(s){return this.messageMap.set("help",s),this}_record(){const s=Array.from(this.messageMap.values()),e=util_1.default.format(this._formatLog("root"),...s);this.messageMap.clear(),this.errList.push(e)}_printAllExit(){if(0===this.errList.length)return;for(let s=0;s<this.errList.length-1;s++)this.error(this.errList[s]);const s=this.errList[this.errList.length-1];this.errList=[],this.errorMessageExit(s)}_format(){const s=Array.from(this.messageMap.values()),e=util_1.default.format(this._formatLog("root"),...s);return this.messageMap.clear(),e}_file(s,e=-1,t=-1){let r=`at ${s}`;return e>0&&(r+=`:${e}`,t>0&&(r+=`:${t}`)),this.messageMap.set("file",r),this}_callstack(s){return this.getLevel()===log4js_1.levels.DEBUG&&this.messageMap.set("callstack",s),this}_printDebugCommand(s,e){this.debug(`[${s}]\n`,e)}_printWarn(s){const e=Array.from(this.messageMap.values());this.warn(this._formatLog(s),...e)}_printError(s){const e=Array.from(this.messageMap.values());this.error(this._formatLog(s),...e)}_printErrorAndExit(s="root"){const e=Array.from(this.messageMap.values());this.errorMessageExit(this._formatLog(s),...e)}_formatLog(s){let e=this.messageMap.has("code")?"[%s]%s":"%s";for(const s of this.messageMap.keys())switch(s){case"solution":e+=`${os_1.default.EOL}\t Detail: %s`;break;case"help":e+=`${os_1.default.EOL}\t Help: %s`;break;case"file":e+=`${os_1.default.EOL}\t %s`;break;case"callstack":e+=`${os_1.default.EOL+os_1.default.EOL}    %s`}return e}}exports.OhosLogger=OhosLogger;